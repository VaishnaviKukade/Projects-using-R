
Regression Analysis
Canadian Census Data Survey-Women in Occupation
1) Use R-squared value as % influence. Include F-value and p-value validation to check association of you X value.
2) Use equation to quote magnitude of change e.g., # X change influence on Y value.
3) Determine validity of the intercept e.g., X=0 and it's corresponding Y value.
4) Validate the equation using real data statistics. Compare real data values/statistics to the numbers generated by your model equation.

Data Dictionary:
* Education:
Average education of occupational candidates, years, in 1971.
* Income:
Average income of incumbents, dollars, in 1971.
* Women:
Percentage of candidates who are women.
* Prestige Rating: This is a Pineo-Porter prestige score for occupation, from a social survey conducted in the mid-1960s. 
* Census:
Canadian Census occupational code.
* Type of occupation: A factor with levels – 
1. bc, Blue Collar;
2. prof, Professional, Managerial, and Technical; 
3. wc, White Collar.
* Few Questions posed for regression analysis: 
1. How does years of education affect one’s income?
2. Do women being in the profession affect the overall income percentage?
3. How does percentage of women affect the prestige rating of the occupation?
4. How is income of a person and prestige of one’s occupation related?
5. How do types of occupation- Blue collar, white collar affect prestige rating  of an occupation?




1) First, to derive the R-squared, F- value and P-values, we plot graphs and summarize the relationships-
# A scatterplot of both variables to see their relationship: Between Education and Income
# Create a plot of the subset data.
library(ggplot2) # Library to create scatterplots/ graphs.
>qplot(education, income, data = newdata, main = "Relationship between Income and Education") + scale_y_continuous(breaks = c(1000, 2000, 4000, 6000, 8000, 10000, 12000, 14000, 16000, 18000, 20000, 25000), minor_breaks = NULL) + scale_x_continuous(breaks = c(6:16), minor_breaks = NULL)


* This graph shows the relationship between Income of women and education of Women in years. 
* Each point on the graph represents a profession.
* One can see proportional change in income as years of education increases. 

* For fitting linear models, we use the ‘lm’ model in R. It is used for linear regression.  



Output: 

* R-squared value as % influence and F-value and p-value validation: 
a) We can see a significant p-value (very close to zero).
b) Though, the model generated does not yield a strong R-square value. R-square value indicates the proportional variance of income explained by education. The closer the R-squared value to zero, the independent variables do not explain much variability in the data. In our model results, the R-square value we get is 0.33. This suggests the linear model we just fit in the data is explaining a mere 33% of the variance observed in the data.


2) Analysis based on the equation-
Now we’ll perform linear regression and check how the linear model suits the data observations. We shall take help of the linear model and try to check if a straight line is able to explain the relationship.

      Y= B0 + B1X+ e
      Where in our case,
           Income= B0 + B1*Education + e
* The linear model follows the linearity equation y = mx + c, where the model will compute the intercept B0 and slope B1. 
* Here the intercept is the expected income value for the average years of education and slope is average increase in income.
* Ideally, the line should fit and get created as close to the data points as possible.
 

3) Now to examine how the fitted line looks like in the scatter plot-
# visualize the model results.
>qplot(education.c, income, data = newdata, main = "Relationship between Income and Education") + stat_smooth(method="lm", col="red", se=FALSE) + scale_y_continuous(breaks = c(1000, 2000, 4000, 6000, 8000, 10000, 12000, 14000, 16000, 18000, 20000, 25000), minor_breaks = NULL)














Graph-





Observations from the scatter plot and model output-
* The graph shows that the relationship between income and education does not follow a straight line. Although this visual is not sufficient to indicate non-linearity, but it can suggest the fact that the relationship is non-linear, since the line does not accommodate/ follow all the data points. 
* From the model output the residual standard error measures the average amount of income that will deviate from the true regression line for any given point. In our example, any prediction of income on the basis of education will be off by an average of $3,483.
* Given that the Residual standard error for income is $3483 and the mean income value is $6798, we can assume that the average percentage error for any given point is more than 51%.




To support, we shall plot the residuals against the predicted values-
# visualize residuals and fitted values.
>plot(mod1, pch=16, which=1)





* The graph above shows the model residuals, ie. the average amount that the response will deviate from the true regression line, plotted against the fitted values
* Ideally, when the model fits the data well, the residuals would be randomly scattered around the horizontal line. In our case here, there is strong evidence that a non-linear pattern is present in the relationship.
* There are points standing far away from the horizontal line indicate the presence of outliers
Multiple Regression:
Using all the other variable we plot a multiple regression model graph. The below scatter plot of the dependent variable prestige and the predictor income shows a nonlinear shape of data points-
>scatterplotMatrix(~ prestige + income +education + women, span =0.7, data = Prestige)

Graph- 




























4) To validate the data with a correlation plot:


This correlation graph represents that the correlation between  prestige and education is very high, ie. 0.85. It shows that the number of years in education highly affects the profession’s level of prestige. 














5) Multiple Regression: Output and Interpretation-
To perform multiple regression we use following equation-
Income=B0+B1?Education+B2?Prestige+B3?Women 
This regression model will help us to calculate intercept B0 and value of each predictor’s slope (B1) for education (B2) for prestige and (B3) for women. 
>prestige.mod1 <- lm(prestige ~ education + income + women, data= Prestige)

>summary(prestige.mod1)

* We have here that, B1=4.1866 represents that the prestige rating is expected to increase by 4.1866 units every next year of education.
* The women coefficient has B3=0.0469, P-value is 0.77, that being greater than the alpha level=0.05. Hence there is no strong relationship between number of women in the occupation and the prestige rating with all other dependent variables being constant. Thus, we can even create a regression model without ‘women’ for the analysis.








* Hence, the second regression model without ‘women’ variable-

























6) Comparing the two Regression models:
>stargazer(prestige.mod1,prestige.mod2,title="Comparison of 2 Regression outputs",type="text",align=TRUE)




Conclusion: Multiple regression reveals that the prestige rating is expected to increase as the number of years of education and income increases. 
Hence, the prestige rating has a positive linear relationship with predictors- education and income.






